#ifndef PATTERN_SCAN_H
#define PATTERN_SCAN_H
#include <Windows.h>
#include <string>
#include <vector>
#include <iostream>
#include <psapi.h>

uintptr_t FindPattern(const BYTE* lpPattern, LPCSTR szMask);
std::vector<BYTE> HexToBytes(const std::string& hex);

// Patterns
static const BYTE* bindSingletonFunction_PATTERN = reinterpret_cast<const BYTE*>("\x56\x57\x53\x48\x83\xec\x00\x4c\x89\xc7\x48\x89\xd6\x49\x89\xc8\x48\x83\x79\x00\x00\x72\x00\x4d\x8b\x00\x48\x8b\x0d\x00\x00\x00\x00\x48\x8b\x41\x00\x48\x8b\x40\x00\x48\x8b\x50\x00\x48\x83\xc2\x00\xe8\x00\x00\x00\x00\x48\x89\xf9\xe8\x00\x00\x00\x00\x48\x83\x7e\x00\x00\x72\x00\x48\x8b\x36\x48\x8b\x0d\x00\x00\x00\x00\x48\x8b\x51\x00\x48\x83\xc2\x00\x49\x89\xf0\xe8\x00\x00\x00\x00\x48\x8b\x35\x00\x00\x00\x00\x48\x8b\x7e\x00\x48\x83\xc7\x00\x48\x39\x7e\x00\x72\x00\x48\x89\xfb\x48\x2b\x5e\x00\x48\x89\xf1\x48\x89\xfa\xe8\x00\x00\x00\x00\x48\x8b\x56\x00\x48\x39\xfa\x73\x00\x48\x89\x7e\x00\x48\x83\xc4\x00\x5b\x5f\x5e\xc3\x48\x8b\x46\x00\xeb\x00\x66\x66\x66\x66\x66\x66\x2e\x0f\x1f\x84\x00\x00\x00\x00\x00\x48\x89\x4e\x00\x48\x89\xf1\x41\xb8\x00\x00\x00\x00\x45\x31\xc9\xe8\x00\x00\x00\x00\x48\x8b\x46\x00\x48\x8b\x56\x00\x48\x8d\x0c\x18\x48\x39\xca\x72\x00\x44\x0f\xb7\x42\x00\x41\xc1\xe0\x00\x48\x89\xd1\x4c\x29\xc1\x48\x39\xc1\x76\x00\x66\x0f\x1f\x44\x00\x00\x66\x83\x79\x00\x00\x75\x00\x48\x81\xc1\x00\x00\x00\x00\x48\x39\xc1\x77\x00\xeb\x00\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\x56\x57\x53\x48\x83\xec\x00\x4c\x89\xc7");
static LPCSTR bindSingletonFunction_MASK = "xxxxxx?xxxxxxxxxxxx??x?xxxxxx????xxx?xxx?xxx?xxx?x????xxxx????xxx??x?xxxxxx????xxx?xxx?xxxx????xxx????xxx?xxx?xxx?x?xxxxxx?xxxxxxx????xxx?xxxx?xxx?xxx?xxxxxxx?x?xxxxxxxxxxx????xxx?xxxxx????xxxx????xxx?xxx?xxxxxxxx?xxxx?xxx?xxxxxxxxxx?xxxxx?xxx??x?xxx????xxxx?x?xxxxxxxxxxxxxxxxx?xxx";

static const BYTE* bindClassMemberFunction_PATTERN =  reinterpret_cast<const BYTE*>("\x56\x57\x53\x48\x83\xec\x00\x4c\x89\xc7\x48\x89\xd6\x49\x89\xc8\x48\x83\x79\x00\x00\x72\x00\x4d\x8b\x00\x48\x8b\x0d\x00\x00\x00\x00\x48\x8b\x41\x00\x48\x8b\x40\x00\x48\x8b\x50\x00\x48\x83\xc2\x00\xe8\x00\x00\x00\x00\x48\x89\xf9\xe8\x00\x00\x00\x00\x48\x83\x7e\x00\x00\x72\x00\x48\x8b\x36\x48\x8b\x0d\x00\x00\x00\x00\x48\x8b\x51\x00\x48\x83\xc2\x00\x49\x89\xf0\xe8\x00\x00\x00\x00\x48\x8b\x35\x00\x00\x00\x00\x48\x8b\x7e\x00\x48\x83\xc7\x00\x48\x39\x7e\x00\x72\x00\x48\x89\xfb\x48\x2b\x5e\x00\x48\x89\xf1\x48\x89\xfa\xe8\x00\x00\x00\x00\x48\x8b\x56\x00\x48\x39\xfa\x73\x00\x48\x89\x7e\x00\x48\x83\xc4\x00\x5b\x5f\x5e\xc3\x48\x8b\x46\x00\xeb\x00\x66\x66\x66\x66\x66\x66\x2e\x0f\x1f\x84\x00\x00\x00\x00\x00\x48\x89\x4e\x00\x48\x89\xf1\x41\xb8\x00\x00\x00\x00\x45\x31\xc9\xe8\x00\x00\x00\x00\x48\x8b\x46\x00\x48\x8b\x56\x00\x48\x8d\x0c\x18\x48\x39\xca\x72\x00\x44\x0f\xb7\x42\x00\x41\xc1\xe0\x00\x48\x89\xd1\x4c\x29\xc1\x48\x39\xc1\x76\x00\x66\x0f\x1f\x44\x00\x00\x66\x83\x79\x00\x00\x75\x00\x48\x81\xc1\x00\x00\x00\x00\x48\x39\xc1\x77\x00\xeb\x00\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\x56\x57\x53\x48\x83\xec\x00\x4c\x8b\x09");
static LPCSTR bindClassMemberFunction_MASK = "xxxxxx?xxxxxxxxxxxx??x?xxxxxx????xxx?xxx?xxx?xxx?x????xxxx????xxx??x?xxxxxx????xxx?xxx?xxxx????xxx????xxx?xxx?xxx?x?xxxxxx?xxxxxxx????xxx?xxxx?xxx?xxx?xxxxxxx?x?xxxxxxxxxxx????xxx?xxxxx????xxxx????xxx?xxx?xxxxxxxx?xxxx?xxx?xxxxxxxxxx?xxxxx?xxx??x?xxx????xxxx?x?xxxxxxxxxxxxxxxxx?xxx";

static const BYTE* bindSingletonFunction_x86_PATTERN = reinterpret_cast<const BYTE*>("\x55\x8b\xec\x8b\x45\x00\x83\x78\x00\x00\x00\x00\x8b\x00\x50\x68\x00\x00\x00\x00\xff\x35\x00\x00\x00\x00\xe8\x00\x00\x00\x00\x83\xc4");
static LPCSTR bindSingletonFunction_x86_MASK = "xxxxx?xx????xxxx????xx????x????xx";

/*
static const BYTE* realera_x86_PATTERN = reinterpret_cast<const BYTE*>("\x8b\x54\x24\x00\x8b\x44\x24\x00\x53\x56\x8b\x72");
static LPCSTR realera_x86_MASK = "xxx?xxx?xxxx";
*/
static const BYTE* realera_x86_PATTERN = reinterpret_cast<const BYTE*>("\x8b\x54\x24\x00\x8b\x00\x24\x00\x53\x56");
static LPCSTR realera_x86_MASK = "xxx?x?x?xx";



#endif //PATTERN_SCAN_H
